<!DOCTYPE html>
<html lang="sv"> <!--  Anger att spr√•ket p√• sidan √§r svenska -->
<head>
  <meta charset="UTF-8" /> <!--  St√∂der svenska tecken (√•, √§, √∂) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <!-- üì± G√∂r sidan responsiv -->
  <title>Lugn & Trygg</title> <!-- üè∑Ô∏è Titel som visas i webbl√§sarfliken -->

  <!-- FontAwesome ikoner -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <!-- Favicon and PWA -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <meta name="theme-color" content="#4CAF50">
  <meta name="color-scheme" content="light dark">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Lugn & Trygg">
  <link rel="apple-touch-icon" href="/icon-192.png">

  <!-- Service Worker and Manifest -->
  <!-- Manifest temporarily disabled due to Vercel caching issues -->
  <!-- <link rel="manifest" href="/site.webmanifest" crossorigin="use-credentials"> -->
  <!-- Force redeploy v4 - Vercel not picking up changes -->

</head>
<body>
  <noscript>
    <style>
      .no-js-fallback { display: block; padding: 2rem; background: #fffbe6; color: #333; text-align: center; }
      .no-js-fallback img { margin: 2rem auto; max-width: 200px; display: block; }
    </style>
    <div class="no-js-fallback">
      <img src="/logo.png" alt="Lugn & Trygg logotyp" />
      <h1>Lugn & Trygg kr√§ver JavaScript</h1>
      <p>F√∂r b√§sta upplevelse, aktivera JavaScript i din webbl√§sare.</p>
      <p>Om du har problem, kontakta <a href="mailto:support@lugn-trygg.se">supporten</a>.</p>
      <p><a href="https://lugn-trygg.se">Till startsidan</a></p>
    </div>
  </noscript> <!-- ‚ö†Ô∏è Meddelande om JavaScript √§r inaktiverat -->

  <!--  Root-element d√§r React-applikationen renderas -->
  <div id="root"></div>

  <!--  CRITICAL FIX: Load React SYNCHRONOUSLY before any modules -->
  <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  
  <!--  React shim INLINE to ensure all chunks can find React -->
  <script>
    (function() {
      'use strict';
      
      // Check if React is loaded from CDN
      if (typeof window.React !== 'undefined' && typeof window.ReactDOM !== 'undefined') {
        console.log('‚úì React ' + window.React.version + ' loaded from CDN');
        
        // Make React available as ES module exports for compatibility with bundled code
        if (typeof window.require === 'undefined') {
          window.require = function(moduleName) {
            if (moduleName === 'react') return window.React;
            if (moduleName === 'react-dom') return window.ReactDOM;
            if (moduleName === 'react/jsx-runtime') {
              return {
                jsx: window.React.createElement,
                jsxs: window.React.createElement,
                Fragment: window.React.Fragment
              };
            }
            throw new Error('Module not found: ' + moduleName);
          };
        }
        
        // Patch any module loaders to use global React
        var originalDefine = window.define;
        if (typeof originalDefine === 'function' && originalDefine.amd) {
          window.define = function(name, deps, factory) {
            if (Array.isArray(deps)) {
              deps = deps.map(function(dep) {
                if (dep === 'react') return window.React;
                if (dep === 'react-dom') return window.ReactDOM;
                return dep;
              });
            }
            return originalDefine.call(this, name, deps, factory);
          };
          window.define.amd = originalDefine.amd;
        }
        
      } else {
        console.error('‚ö†Ô∏è React NOT loaded! App will fail.');
        document.getElementById('root').innerHTML = 
          '<div style="padding:2rem;background:#fee;color:#c00;text-align:center;">' +
          '<h1>‚ö†Ô∏è Tekniskt fel</h1>' +
          '<p>React kunde inte laddas fr√•n CDN. Ladda om sidan.</p>' +
          '<p style="font-size:0.9em;color:#666;">Kontakta support om problemet kvarst√•r.</p>' +
          '</div>';
      }
    })();
  </script>

  <!--  jsPDF via CDN for PDF export functionality -->
  <script id="jspdf-cdn" src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js" defer></script>
  <!--  Laddar React-applikationen - AFTER React is verified -->
  <script type="module" src="/src/main.tsx"></script>
</body>
</html>
