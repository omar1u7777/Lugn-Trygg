# Monitoring Dashboard Configuration for Lugn & Trygg
# This file configures monitoring dashboards and alerts

# Sentry Configuration
SENTRY_DSN=https://your-sentry-dsn-here@lugn-trygg.sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=1.0.0

# Application Metrics
METRICS_ENDPOINT=/metrics
METRICS_PORT=9090

# Health Check Endpoints
HEALTH_CHECK_ENDPOINTS:
  - url: http://localhost:3000/health
    name: Frontend Health
    timeout: 30
  - url: http://localhost:5001/health
    name: Backend Health
    timeout: 30
  - url: https://lugn-trygg.firebase.com/health
    name: Firebase Health
    timeout: 30

# Alert Thresholds
ALERT_THRESHOLDS:
  response_time: 5000  # ms
  error_rate: 0.05     # 5%
  cpu_usage: 80        # %
  memory_usage: 85     # %
  disk_usage: 90       # %

# Notification Channels
NOTIFICATIONS:
  email:
    enabled: true
    recipients:
      - admin@lugntrygg.se
      - dev@lugntrygg.se
    smtp_server: smtp.gmail.com
    smtp_port: 587

  slack:
    enabled: true
    webhook_url: https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
    channel: "#alerts"

  sms:
    enabled: false
    provider: twilio
    phone_numbers:
      - "+46XXXXXXXXX"

# Dashboard Panels
DASHBOARD_PANELS:
  - name: "User Activity"
    type: "time_series"
    metrics:
      - active_users
      - new_registrations
      - mood_entries

  - name: "System Performance"
    type: "gauge"
    metrics:
      - cpu_usage
      - memory_usage
      - response_time

  - name: "Error Monitoring"
    type: "bar_chart"
    metrics:
      - error_count
      - error_rate
      - top_errors

  - name: "Database Performance"
    type: "line_chart"
    metrics:
      - query_time
      - connection_count
      - backup_status

# Log Aggregation
LOG_AGGREGATION:
  level: INFO
  format: json
  destinations:
    - file: logs/app.log
    - elasticsearch:
        host: localhost
        port: 9200
        index: lugn-trygg-logs

# APM (Application Performance Monitoring)
APM_CONFIG:
  enabled: true
  sampling_rate: 0.1  # 10% of requests
  ignore_paths:
    - /health
    - /metrics
    - /static/*

# Custom Metrics
CUSTOM_METRICS:
  - name: mood_entries_per_hour
    type: counter
    description: "Number of mood entries logged per hour"

  - name: user_session_duration
    type: histogram
    buckets: [60, 300, 900, 1800, 3600]  # seconds

  - name: api_response_time
    type: histogram
    buckets: [0.1, 0.5, 1.0, 2.0, 5.0]  # seconds

# Alert Rules
ALERT_RULES:
  - name: "High Error Rate"
    condition: "error_rate > 0.05"
    duration: "5m"
    severity: critical
    message: "Error rate is above 5% for the last 5 minutes"

  - name: "High Response Time"
    condition: "response_time > 5000"
    duration: "10m"
    severity: warning
    message: "Average response time is above 5 seconds"

  - name: "Low Disk Space"
    condition: "disk_usage > 90"
    duration: "5m"
    severity: critical
    message: "Disk usage is above 90%"

# Backup Monitoring
BACKUP_MONITORING:
  enabled: true
  schedule: "0 2 * * *"  # Daily at 2 AM
  retention_days: 30
  alert_on_failure: true

# Security Monitoring
SECURITY_MONITORING:
  enabled: true
  failed_login_attempts: 5
  lockout_duration: 900  # 15 minutes
  suspicious_ips:
    - "blocklist.txt"
  rate_limiting:
    enabled: true
    max_requests: 1000
    window_seconds: 3600